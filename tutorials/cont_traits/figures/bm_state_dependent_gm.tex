\begin{tikzpicture}
\node[obnode] (ny) at (0,0) {\LARGE $Y$};
\node[obnode] (nx) at ($(ny)+(-2,2)$) {\LARGE $X$};
\node[constnode] (phy) at ($(ny)+(-2,0)$) {\LARGE $\Psi$};
\node[detnode] (si) at ($(ny)+(4,3)$) {\Large $\sigma^2_i$};
\node[detnode] (tij) at ($(si)+(-2,2)$) {$\tau_i(j)$};
\node[snode] (zeta) at ($(si)+(3.5,0)$) {\Large $\boldsymbol{\zeta^2}$};
\node[snode] (beta) at ($(si)+(3.5,2)$) {\Large $\beta^2$};
\node[constnode] (q) at ($(nx)+(-2,0)$) {\LARGE $Q$};
\node[snode] (lambda) at ($(nx)+(0,2)$) {\LARGE $\lambda$};
\node[constnode] (ml) at ($(lambda)+(-2,2)$) {\LARGE $\mu_\lambda$};
\node[constnode] (sl) at ($(lambda)+(0,2)$) {\LARGE $\sigma_\lambda$};
\node[constnode] (al) at ($(zeta)+(2,0)$) {\LARGE $\alpha$};
\node[constnode] (l) at ($(beta)+(2,0)$) {\LARGE $L$};
\node[constnode] (u) at ($(beta)+(2,2)$) {\LARGE $U$};
\draw [dtaro] (si) -- (ny);
\draw [dtaro] (tij) -- (si);
\draw [dtaro] (nx) -- (tij);
\draw [taro] (zeta) -- (si);
\draw [taro] (beta) -- (si);
\draw [taro] (phy) -- (nx);
\draw [taro] (phy) -- (ny);
\draw [taro] (q) -- (nx);
\draw [taro] (lambda) -- (nx);
\draw [taro] (ml) -- (lambda);
\draw [taro] (sl) -- (lambda);
\draw [taro] (al) -- (zeta);
\draw [taro] (u) -- (beta);
\draw [taro] (l) -- (beta);
\node[white, fill=blue, shape=rectangle, rounded corners, align=center] at ($(q)+(0,-0.75)$) [below]{rate matrix};
\node[white, fill=blue, shape=rectangle, rounded corners, align=center] at ($(lambda)+(-0.75,0)$) [left]{transition rate};
\node[white, fill=blue, shape=rectangle, rounded corners, text width=2.5cm, align=center] at ($(zeta)+(0,-0.75)$) [below]{state-dependent rates};
\node[white, fill=blue, shape=rectangle, rounded corners, align=center] at ($(beta)+(0,-0.75)$) [below]{average rate};
\node[white, fill=blue, shape=rectangle, rounded corners, align=center] at ($(phy)+(0,-0.75)$) [below]{phylogeny};
\node[white, fill=blue, shape=rectangle, rounded corners, align=center] at ($(si)+(0,-0.75)$) [below] (branchrates) {branch rates};
\node[white, fill=blue, shape=rectangle, rounded corners, align=center] at ($(ml)+(0,0.75)$) [above] {prior mean};
\node[white, fill=blue, shape=rectangle, rounded corners, align=center] at ($(sl)+(0,0.75)$) [above] {prior sd};
\node[white, fill=blue, shape=rectangle, rounded corners, align=center] at ($(u)+(0.75,0)$) [right] {upper bound};
\node[white, fill=blue, shape=rectangle, rounded corners, align=center] at ($(l)+(0.75,0)$) [right] {lower bound};
\node[white, fill=blue, shape=rectangle, rounded corners, align=center] at ($(al)+(0.75,0)$) [right] {concentration};
\node[rectangle,dashed, very thick, inner sep=6mm, draw=black!100, fit = (tij)] (stateplate) {};
\node[rectangle,dashed, very thick, inner sep=6mm, draw=black!100, fit = (stateplate)(si)(branchrates)] (rateplate) {};
\node[anchor=north east,inner sep=7pt] at (stateplate.north east) {\small $j \in k$};
\node[anchor=north east,inner sep=7pt] at (rateplate.north east) {\small $i \in N$};
\node[white, fill=blue, shape=rectangle, rounded corners, align=center, text width=1.2cm] at ($(tij)+(0,-0.75)$) [below]{dwelling times};
\end{tikzpicture}
